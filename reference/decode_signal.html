<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Highlights and test the time-course of effects through crossvalidation — decode_signal • Pupilla</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Highlights and test the time-course of effects through crossvalidation — decode_signal"><meta name="description" content="This function is meant to implement, roughly and with no assurance of full compatibility
the procedure proposed by Mathôt and Vilotijević (2022, Behavior Research Methods).
First, each trial (i.e., one complete time series) is assigned to one fold in a
deterministic fashion (the first trial to the first fold, then the second trial to
the second fold, etc.). In doing that, there is no regard of how conditions are
distributed across folds, i.e. data may be slightly unbalanced; thus, you should think
carefully as to whether this strategy applies to your design (e.g., blocked conditions).
Then, data are separated for each time-point, and a LMEM as specified by the 'formula'
parameter, which is passed to 'lmerTest::lmer', is performed by iteratively leaving
one fold out. This results in a table, with as many rows as effects implied
by the formula by 'nfolds', summarising which time point had a peak t-value (in absolute value)
in the trained folds. In a separate table these peak values are tested: the dependent
variable becomes, for each fold, the variable provided by 'dv' at that specific peak.
Another LMEM is then computed by using this newly created variable. One problem with
this approach is that peak values can be all over the places, depending on your data.
Also, choosing the time-points based on the maximum value in the training dataset can
occasionally decrease the precision of the estimate or give overfitting. You may use
this approach if you are confident that a specific effect only has an effect at a specific
window; effects with multiple windows - e.g., an early and late impact on pupil size - may
not be properly captured with this approach. Therefore,
in addition to this procedure, a very coarse consensus is seek by assessing,
across all folds and effects, which time points resulted in t-values above a certain
threshold; if the same time points pop out consistently across folds (e.g.,= 'consensus_thresh' % of the times), then the time point is retained; all time-pointsretained in the consensus are collapsed (averaged), and a final LMEM is performed withthese time points. This can be interpreted more similarly to a cluster-basedpermutation test (although it is not the same)."><meta property="og:description" content="This function is meant to implement, roughly and with no assurance of full compatibility
the procedure proposed by Mathôt and Vilotijević (2022, Behavior Research Methods).
First, each trial (i.e., one complete time series) is assigned to one fold in a
deterministic fashion (the first trial to the first fold, then the second trial to
the second fold, etc.). In doing that, there is no regard of how conditions are
distributed across folds, i.e. data may be slightly unbalanced; thus, you should think
carefully as to whether this strategy applies to your design (e.g., blocked conditions).
Then, data are separated for each time-point, and a LMEM as specified by the 'formula'
parameter, which is passed to 'lmerTest::lmer', is performed by iteratively leaving
one fold out. This results in a table, with as many rows as effects implied
by the formula by 'nfolds', summarising which time point had a peak t-value (in absolute value)
in the trained folds. In a separate table these peak values are tested: the dependent
variable becomes, for each fold, the variable provided by 'dv' at that specific peak.
Another LMEM is then computed by using this newly created variable. One problem with
this approach is that peak values can be all over the places, depending on your data.
Also, choosing the time-points based on the maximum value in the training dataset can
occasionally decrease the precision of the estimate or give overfitting. You may use
this approach if you are confident that a specific effect only has an effect at a specific
window; effects with multiple windows - e.g., an early and late impact on pupil size - may
not be properly captured with this approach. Therefore,
in addition to this procedure, a very coarse consensus is seek by assessing,
across all folds and effects, which time points resulted in t-values above a certain
threshold; if the same time points pop out consistently across folds (e.g.,= 'consensus_thresh' % of the times), then the time point is retained; all time-pointsretained in the consensus are collapsed (averaged), and a final LMEM is performed withthese time points. This can be interpreted more similarly to a cluster-basedpermutation test (although it is not the same)."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Pupilla</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.2.01</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/Pupilla.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Pupilla_Advanced_statistical_analyses.html">Pupilla::Advanced_statistical_analyses</a></li>
    <li><a class="dropdown-item" href="../articles/Pupilla_Assessing_Pupillary_Manifold.html">Pupilla::Assessing_Pupillary_Manifold</a></li>
    <li><a class="dropdown-item" href="../articles/Pupilla_Eyelink_SingleSubjectPreprocessing.html">Pupilla::EyeLink::Read_and_preprocess</a></li>
    <li><a class="dropdown-item" href="../articles/Pupilla_TOBII_ReduceFeatures.html">Pupilla::TOBII::Reduce_Features</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/EBlini/Pupilla/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Highlights and test the time-course of effects through crossvalidation</h1>
      <small class="dont-index">Source: <a href="https://github.com/EBlini/Pupilla/blob/main/R/decode_signal.R" class="external-link"><code>R/decode_signal.R</code></a></small>
      <div class="d-none name"><code>decode_signal.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function is meant to implement, roughly and with no assurance of full compatibility
the procedure proposed by Mathôt and Vilotijević (2022, <em>Behavior Research Methods</em>).
First, each trial (i.e., one complete time series) is assigned to one fold in a
deterministic fashion (the first trial to the first fold, then the second trial to
the second fold, etc.). In doing that, there is no regard of how conditions are
distributed across folds, i.e. data may be slightly unbalanced; thus, you should think
carefully as to whether this strategy applies to your design (e.g., blocked conditions).
Then, data are separated for each time-point, and a LMEM as specified by the 'formula'
parameter, which is passed to 'lmerTest::lmer', is performed by iteratively leaving
one fold out. This results in a table, with as many rows as effects implied
by the formula by 'nfolds', summarising which time point had a peak t-value (in absolute value)
in the trained folds. In a separate table these peak values are tested: the dependent
variable becomes, for each fold, the variable provided by 'dv' at that specific peak.
Another LMEM is then computed by using this newly created variable. One problem with
this approach is that peak values can be all over the places, depending on your data.
Also, choosing the time-points based on the maximum value in the training dataset can
occasionally decrease the precision of the estimate or give overfitting. You may use
this approach if you are confident that a specific effect only has an effect at a specific
window; effects with multiple windows - e.g., an early and late impact on pupil size - may
not be properly captured with this approach. Therefore,
in addition to this procedure, a very coarse consensus is seek by assessing,
across all folds and effects, which time points resulted in t-values above a certain
threshold; if the same time points pop out consistently across folds (e.g.,= 'consensus_thresh' % of the times), then the time point is retained; all time-pointsretained in the consensus are collapsed (averaged), and a final LMEM is performed withthese time points. This can be interpreted more similarly to a cluster-basedpermutation test (although it is not the same).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">decode_signal</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">formula</span>,</span>
<span>  <span class="va">dv</span>,</span>
<span>  <span class="va">time</span>,</span>
<span>  <span class="va">id</span>,</span>
<span>  <span class="va">trial</span>,</span>
<span>  nfolds <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  t_thresh <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  consensus_thresh <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span>  formula_max <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A data.frame containing all the necessary variables.</p></dd>


<dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>A 'lme4'-style formula, passed as a string.</p></dd>


<dt id="arg-dv">dv<a class="anchor" aria-label="anchor" href="#arg-dv"></a></dt>
<dd><p>A string indicating the name of the dependent variable.</p></dd>


<dt id="arg-time">time<a class="anchor" aria-label="anchor" href="#arg-time"></a></dt>
<dd><p>A string indicating the name of the time variable.</p></dd>


<dt id="arg-id">id<a class="anchor" aria-label="anchor" href="#arg-id"></a></dt>
<dd><p>A string indicating the name of the id (participant) variable.</p></dd>


<dt id="arg-trial">trial<a class="anchor" aria-label="anchor" href="#arg-trial"></a></dt>
<dd><p>A string indicating the name of the trial variable.</p></dd>


<dt id="arg-nfolds">nfolds<a class="anchor" aria-label="anchor" href="#arg-nfolds"></a></dt>
<dd><p>Number of folds to split trials in. Defaults to 3.</p></dd>


<dt id="arg-t-thresh">t_thresh<a class="anchor" aria-label="anchor" href="#arg-t-thresh"></a></dt>
<dd><p>Used to seek consensus: the minimum t-value required to push the
time-point forward.</p></dd>


<dt id="arg-consensus-thresh">consensus_thresh<a class="anchor" aria-label="anchor" href="#arg-consensus-thresh"></a></dt>
<dd><p>The minimum proportion of time-points that must be above
't_thresh' across folds in order to keep the time-point in the consensus.</p></dd>


<dt id="arg-formula-max">formula_max<a class="anchor" aria-label="anchor" href="#arg-formula-max"></a></dt>
<dd><p>A 'lme4'-style formula, passed as a string. This formula is
only used to test the final models. Could be useful to save computational resources.
I do not necessarily recommend it because it could be overly conservative and prone to convergence issues.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list including: peaks retained for each (left-out) fold; test of the
retained, cross-validated peaks; test of the consensus time-points, if any; list
of time-points retained in the consensus for each effect.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Elvio Blini.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

