<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Pupilla">
<title>Pupilla::Advanced statistical analyses • Pupilla</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Pupilla::Advanced statistical analyses">
<meta property="og:description" content="Pupilla">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">Pupilla</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9001</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/Pupilla.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Pupilla_Advanced_statistical_analyses.html">Pupilla::Advanced statistical analyses</a>
    <a class="dropdown-item" href="../articles/Pupilla_Assessing_Pupillary_Manifold.html">Pupilla::Assessing_Pupillary_Manifold</a>
    <a class="dropdown-item" href="../articles/Pupilla_Eyelink_SingleSubjectPreprocessing.html">Pupilla::EyeLink::Read and preprocessing</a>
    <a class="dropdown-item" href="../articles/Pupilla_TOBII_ReduceFeatures%20-%20Copia.html">Pupilla::TOBII_ReduceFeatures</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/EBlini/Pupilla/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Pupilla::Advanced statistical analyses</h1>
                        <h4 data-toc-skip class="author">Elvio
Blini</h4>
            
            <h4 data-toc-skip class="date">February 2024</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/EBlini/Pupilla/blob/HEAD/vignettes/Pupilla_Advanced_statistical_analyses.Rmd" class="external-link"><code>vignettes/Pupilla_Advanced_statistical_analyses.Rmd</code></a></small>
      <div class="d-none name"><code>Pupilla_Advanced_statistical_analyses.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p><code>Pupilla</code> gathers several functions that are designed to
facilitate the analysis of pupillometry experiments as commonly
performed in cognitive neuroscience, e.g. event-related designs,
although its use could be much more general. In this vignette we cover
the statistical modelling step. <code>Pupilla</code> provides functions
to implement two approaches:</p>
<ol style="list-style-type: decimal">
<li><p>Crossvalidated LMEMs as in <a href="https://link.springer.com/article/10.3758/s13428-022-01957-7" class="external-link">Mathôt
&amp; Vilotijević, 2022</a>.</p></li>
<li><p>An original - and thus not yet fully validated in scientific
articles - approach through feature reduction.</p></li>
</ol>
<p>We will use the data from <a href="https://onlinelibrary.wiley.com/doi/full/10.1111/cogs.13194" class="external-link">Zhou
et al., 2022</a> for a better comparison - there are indeed differences
in the implementation of LMEMs in R and Python, on top of course of the
specific choices that I’ve made within this package.</p>
<p>I am grateful to the authors for sharing their data and allowing us
to do reproducible, exploitable science.</p>
</div>
<div class="section level2">
<h2 id="prepping-the-data">Prepping the data<a class="anchor" aria-label="anchor" href="#prepping-the-data"></a>
</h2>
<p>We will need the following R packages:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://dplyr.tidyverse.org" class="external-link">"dplyr"</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'dplyr'</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:stats':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     filter, lag</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:base':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     intersect, setdiff, setequal, union</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/EBlini/Pupilla" class="external-link">"Pupilla"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://ggplot2.tidyverse.org" class="external-link">"ggplot2"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/rvlenth/emmeans" class="external-link">"emmeans"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/runehaubo/lmerTestR" class="external-link">"lmerTest"</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Loading required package: lme4</span></span></code></pre>
<pre><code><span><span class="co">## Loading required package: Matrix</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'lmerTest'</span></span></code></pre>
<pre><code><span><span class="co">## The following object is masked from 'package:lme4':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     lmer</span></span></code></pre>
<pre><code><span><span class="co">## The following object is masked from 'package:stats':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     step</span></span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://zoo.R-Forge.R-project.org/" class="external-link">"zoo"</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'zoo'</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:base':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     as.Date, as.Date.numeric</span></span></code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>dplyr.summarise.inform <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>For the python interface:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://rstudio.github.io/reticulate/" class="external-link">"reticulate"</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># #create python environment</span></span>
<span><span class="co">#conda_create("my_env")</span></span>
<span><span class="co">#use_miniconda("my_env")</span></span>
<span></span>
<span><span class="co"># #install packages in the environment</span></span>
<span><span class="co"># py_install("pandas")</span></span>
<span><span class="co"># py_install("datamatrix")</span></span></code></pre></div>
<p>Note that package <code>reticulate</code> requires a python
environment and the installation of the required modules. This package
is only needed to read <code>.pkl</code> files directly from within R,
that is the original format of the data.<br>
Accordingly, the following chunk is run with python as engine - that is,
you need to include it within a reticulate repl if not using markdown.
We use it to read the <a href="https://github.com/smathot/time_series_test" class="external-link">original data</a>,
convert it to a <code>pandas</code> dataframe, and then move it the R
environment.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="im">from</span> datamatrix <span class="im">import</span> io, convert</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>address<span class="op">=</span> <span class="st">"data</span><span class="ch">\\</span><span class="st">zhou_et_al_2021.pkl"</span></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>data<span class="op">=</span> io.readpickle(address)</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a>data<span class="op">=</span> convert.to_pandas(data)</span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a>quit</span></code></pre></div>
<p>The python environment is available to R as <code>py</code>. We can
thus manipulate the data with the usual functions. In particular, the
variable <code>pupil</code> is read as an array, whereas we would prefer
a long dataframe in R. We thus reshape a bit the data as follows - based
on my understanding of the structure:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">DF</span><span class="op">=</span> <span class="va">py</span><span class="op">$</span><span class="va">data</span> <span class="co">#bring to R</span></span>
<span></span>
<span><span class="va">DF2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">DF</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">res</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    Pupil <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">DF</span><span class="op">$</span><span class="va">pupil</span><span class="op">[[</span><span class="va">x</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    Set_size <span class="op">=</span> <span class="va">DF</span><span class="op">$</span><span class="va">set_size</span><span class="op">[</span><span class="va">x</span><span class="op">]</span>,</span>
<span>    Subject <span class="op">=</span> <span class="va">DF</span><span class="op">$</span><span class="va">subject_nr</span><span class="op">[</span><span class="va">x</span><span class="op">]</span>,</span>
<span>    Color_type <span class="op">=</span> <span class="va">DF</span><span class="op">$</span><span class="va">color_type</span><span class="op">[</span><span class="va">x</span><span class="op">]</span>,</span>
<span>    Time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3</span>, length <span class="op">=</span> <span class="fl">300</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">DF2</span><span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">DF2</span><span class="op">)</span></span></code></pre></div>
<p>We further add an explicit “Trial” variable to the data. The variable
“Set_Size” is also converted to a factor.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">DF2</span><span class="op">=</span> <span class="va">DF2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Subject</span>, <span class="va">Time</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Trial<span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">DF2</span><span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">DF2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">DF2</span><span class="op">$</span><span class="va">Set_size</span><span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">DF2</span><span class="op">$</span><span class="va">Set_size</span><span class="op">)</span></span></code></pre></div>
<p>There are a few <code>NA</code> in the data. It is generally not
problematic for LMEMs, which can handle very well slightly unbalanced
designs, and these values could be very well omitted. It is slightly
more problematic for the second approach, through features reduction, in
that missing values may lead to the loss of an entire trial. For this
approach, some sort of interpolation would be warranted if, of course,
the gaps are not too large. For this vignette we simply interpolate the
missing values linearly through <code><a href="https://rdrr.io/pkg/zoo/man/na.approx.html" class="external-link">zoo::na.approx()</a></code>. Note that
this function will not work when NAs are located at the beginning or the
end of a vector, so that we won’t get rid of all NAs.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">DF2</span><span class="op">$</span><span class="va">Pupil</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 35786</span></span></code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">DF2</span><span class="op">=</span> <span class="va">DF2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Subject</span>, <span class="va">Trial</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Pupil<span class="op">=</span> <span class="fu">zoo</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/zoo/man/na.approx.html" class="external-link">na.approx</a></span><span class="op">(</span><span class="va">Pupil</span>, na.rm <span class="op">=</span> <span class="cn">F</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">DF2</span><span class="op">$</span><span class="va">Pupil</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 2009</span></span></code></pre>
<p>We then plot the average pupil size by Set_Size and Color_type. The
plot looks quite like the <a href="https://github.com/smathot/time_series_test" class="external-link">original one</a>, so
that we sould not be too far off from the original data.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">DF2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Subject</span>, <span class="va">Time</span>, <span class="va">Color_type</span>, <span class="va">Set_size</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>Pupil<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">Pupil</span>, na.rm<span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Time</span>, <span class="va">Color_type</span>, <span class="va">Set_size</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>Pupil<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">Pupil</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Set_size<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">Set_size</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y<span class="op">=</span> <span class="va">Pupil</span>, x<span class="op">=</span> <span class="va">Time</span>, </span>
<span>             color<span class="op">=</span> <span class="va">Set_size</span>, </span>
<span>             linetype<span class="op">=</span> <span class="va">Color_type</span>,</span>
<span>             group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/interaction.html" class="external-link">interaction</a></span><span class="op">(</span><span class="va">Set_size</span>, <span class="va">Color_type</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>linewidth<span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>text<span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span> <span class="fl">16</span>,</span>
<span>                           face<span class="op">=</span><span class="st">"bold"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Time (s)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Pupil size (a.u.)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Data from: Zhou, Lorist, and Mathôt (2022)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="images/mathot_plot_data-1.png"></p>
<p>I am not really depicting the variability. However, what matters here
is that: 1) there is a very large effect of Set_Size; 2) there may be
(well, we know from the paper that there is, :) ) an interaction between
Set_Size and Color_type so that the effect of the non-prototypical color
is reversed between 1 and 4. Let’s analyze the data!</p>
</div>
<div class="section level2">
<h2 id="crossvalidated-lmems">Crossvalidated LMEMs<a class="anchor" aria-label="anchor" href="#crossvalidated-lmems"></a>
</h2>
<p>In this approach <a href="https://link.springer.com/article/10.3758/s13428-022-01957-7" class="external-link">Mathôt
&amp; Vilotijević, 2022</a>, all trials from each participant are
assigned deterministically to one of N folds. N-1 folds are circularly
used as the training set; here, LMEMs are performed for each timepoint,
and the timepoint having the peak t-value (for each fixed effect or
interaction) is then used in the test set to confirm the overall
consistency of the target effect across folds. This approach is
computationally efficient and very powerful in suggesting the presence
of a consistent experimental effect <em>somewhere</em> along the time
course of the trials. This is how you would do it in
<code>Pupilla</code>.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#the data</span></span>
<span><span class="va">data</span><span class="op">=</span> <span class="va">DF2</span></span>
<span><span class="co">#lme4::lmer-style formula </span></span>
<span><span class="co">#here we use only random intercepts</span></span>
<span><span class="va">formula</span><span class="op">=</span> <span class="st">"Pupil ~ Set_size*Color_type + (1|Subject)"</span></span>
<span><span class="co">#you also have to supply explicitly the names of the variables</span></span>
<span><span class="va">dv</span><span class="op">=</span> <span class="st">"Pupil"</span></span>
<span><span class="va">time</span><span class="op">=</span> <span class="st">"Time"</span></span>
<span><span class="va">id</span><span class="op">=</span> <span class="st">"Subject"</span></span>
<span><span class="va">trial</span><span class="op">=</span> <span class="st">"Trial"</span></span>
<span><span class="co">#how many folds?</span></span>
<span><span class="va">nfolds</span><span class="op">=</span> <span class="fl">3</span></span>
<span><span class="co">#used for the consensus across folds - see below</span></span>
<span><span class="va">t_thresh</span><span class="op">=</span> <span class="fl">1.9</span></span>
<span><span class="va">consensus_thresh</span> <span class="op">=</span> <span class="fl">0.99</span></span>
<span></span>
<span><span class="va">cv</span><span class="op">=</span> <span class="fu"><a href="../reference/decode_signal.html">decode_signal</a></span><span class="op">(</span>data<span class="op">=</span> <span class="va">data</span>, </span>
<span>                  formula<span class="op">=</span> <span class="va">formula</span>,</span>
<span>                  dv<span class="op">=</span> <span class="va">dv</span>,</span>
<span>                  time<span class="op">=</span> <span class="va">time</span>,</span>
<span>                  id<span class="op">=</span> <span class="va">id</span>,</span>
<span>                  trial<span class="op">=</span> <span class="va">trial</span>,</span>
<span>                  nfolds<span class="op">=</span> <span class="va">nfolds</span>,</span>
<span>                  t_thresh<span class="op">=</span> <span class="va">t_thresh</span>,</span>
<span>                  consensus_thresh<span class="op">=</span> <span class="va">consensus_thresh</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span>
<span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span></code></pre>
<p>That’s it! We first take a look at the global effects, with LMEMs
tested at the relative peaks:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cv</span><span class="op">$</span><span class="va">Peaks_test</span></span></code></pre></div>
<pre><code><span><span class="co">##                      Effect      Test_t    Test_df       Test_p</span></span>
<span><span class="co">## 1               (Intercept) -12.0345532   31.90004 2.127767e-13</span></span>
<span><span class="co">## 2                 Set_size2   7.4219908 7276.01675 1.284641e-13</span></span>
<span><span class="co">## 3                 Set_size3  14.4253720 7276.01727 1.564918e-46</span></span>
<span><span class="co">## 4                 Set_size4  12.6268559 7263.07280 3.595688e-36</span></span>
<span><span class="co">## 5           Color_typeproto  -1.5116082 7269.07742 1.306770e-01</span></span>
<span><span class="co">## 6 Set_size2:Color_typeproto   0.8674076 7270.09839 3.857473e-01</span></span>
<span><span class="co">## 7 Set_size3:Color_typeproto   1.0893240 7273.07358 2.760471e-01</span></span>
<span><span class="co">## 8 Set_size4:Color_typeproto   2.4009727 7273.04856 1.637651e-02</span></span></code></pre>
<p>First, you may notice that results are taken from
<code><a href="https://rdrr.io/pkg/lmerTest/man/lmer.html" class="external-link">lmerTest::lmer()</a></code> and reflect the default contrast settings
of R, that is <strong>treatment coding</strong>. In other words, in the
case of factors the first level is taken as the reference. In this case
it’s pretty clear for us as we aim to compare Set_size 1 vs 4; if you
want to compare explicity other contrasts, you would have to refactor
the variables. In my understanding other packages may perform “omnibus
tests”; in R this is very feasible, e.g. with <code><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">car::Anova()</a></code>,
and perhaps will be implemented in the feature. The interpretation here,
however, is not that of an omnibus test (e.g., a main effect in the
ANOVA), but that of specific comparisons.<br>
You will also notice that the main inferential statistic is a t value,
rather than a z or F value.</p>
<p>That said, the results are positive for Set_size (each differs from
1) and the interaction with Color_type between Set_size 1 and 4. This
would therefore be taken as evidence for the presence of an effect
<em>somewhere</em> along the time course of trials.</p>
<p>The following table reports statistics for each fold, <em>when the
fold was left out</em>. This is useful to understand where the peaks
were located.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cv</span><span class="op">$</span><span class="va">All_Folds</span></span></code></pre></div>
<pre><code><span><span class="co">##    Fold                    Effect     Peak_t Peak_obs  Peak_time</span></span>
<span><span class="co">## 1     1               (Intercept) -12.141355       89 0.88294314</span></span>
<span><span class="co">## 2     2               (Intercept) -11.509067       87 0.86287625</span></span>
<span><span class="co">## 3     3               (Intercept) -12.037152       89 0.88294314</span></span>
<span><span class="co">## 4     1                 Set_size2   6.233502       95 0.94314381</span></span>
<span><span class="co">## 5     2                 Set_size2   5.663626       89 0.88294314</span></span>
<span><span class="co">## 6     3                 Set_size2   7.076464       97 0.96321070</span></span>
<span><span class="co">## 7     1                 Set_size3  12.371973       98 0.97324415</span></span>
<span><span class="co">## 8     2                 Set_size3  11.366762       98 0.97324415</span></span>
<span><span class="co">## 9     3                 Set_size3  11.770977       97 0.96321070</span></span>
<span><span class="co">## 10    1                 Set_size4  13.232442      103 1.02341137</span></span>
<span><span class="co">## 11    2                 Set_size4  12.609223      282 2.81939799</span></span>
<span><span class="co">## 12    3                 Set_size4  13.366514      221 2.20735786</span></span>
<span><span class="co">## 13    1           Color_typeproto  -2.484261      167 1.66555184</span></span>
<span><span class="co">## 14    2           Color_typeproto  -2.121288      159 1.58528428</span></span>
<span><span class="co">## 15    3           Color_typeproto   1.807755        5 0.04013378</span></span>
<span><span class="co">## 16    1 Set_size2:Color_typeproto   2.398834      165 1.64548495</span></span>
<span><span class="co">## 17    2 Set_size2:Color_typeproto   2.987624      156 1.55518395</span></span>
<span><span class="co">## 18    3 Set_size2:Color_typeproto  -1.623268        7 0.06020067</span></span>
<span><span class="co">## 19    1 Set_size3:Color_typeproto   1.707470      158 1.57525084</span></span>
<span><span class="co">## 20    2 Set_size3:Color_typeproto   2.071359      146 1.45484950</span></span>
<span><span class="co">## 21    3 Set_size3:Color_typeproto  -2.007344        8 0.07023411</span></span>
<span><span class="co">## 22    1 Set_size4:Color_typeproto   3.216884      171 1.70568562</span></span>
<span><span class="co">## 23    2 Set_size4:Color_typeproto   2.794211      159 1.58528428</span></span>
<span><span class="co">## 24    3 Set_size4:Color_typeproto   1.950378      142 1.41471572</span></span></code></pre>
<p>First, the comparisons with Set_size 1 vs 2 or 3 are similar in
locating peaks around 1 second. Results are slightly more sparse for the
1 vs 4 comparison (1 to 2.8 s). We did not find a main effect of
Color_type here. This could be due to the contrasts used, to differences
in how trials are assigned to folds, the presence of possible
convergence failures, etc. You will see, for example, that t values for
the main effect of Color_type are positive in two folds, negative in the
other one. This could be due, again, to some funny convergence, or
simply the fact that overfitting occurrred in one specific time point
(sample 5). Below we will introduce the notion of
<strong>consensus</strong> across folds. Finally, the interaction is
also seemingly very consistent between 1.4 and 1.7 seconds.</p>
<p>Overall, it seems to me that there is a good agreement with the
original findings, notwithstanding the differences in the
implementation.</p>
<p>There are, however, a couple of caveats, that are also mentioned by
<a href="https://github.com/smathot/time_series_test" class="external-link">the
authors</a>.</p>
<p>First, the temporal information provided by this approach is rather
coarse. It can test the presence of an effect <em>somewhere</em> along
the course of the trial, though the specific timepoints may be rather
vague.</p>
<p>Second, in the presence of two distinct loci of effects, this
approach would not be entirely appropriate, especially if the direction
of these effects is in the opposite direction.</p>
<p>Finally, because the tested time point is chosen as the one having
the peak statistic (e.g., t value), the approach may be prone to
overfitting; other time points may be, in fact, more representative of
the effects at hand.</p>
<div class="section level3">
<h3 id="consensus">Consensus<a class="anchor" aria-label="anchor" href="#consensus"></a>
</h3>
<p>It is a common problem, in machine learning, having to find a
consensus between the hyperparameters obtained in different folds.
Particularly so if you need to build one final model to interpret the
results (see, e.g., my other package <a href="https://eblini.github.io/FCnet/articles/FCnet_overview_of_package.html" class="external-link">FCnet</a>
for the analysis of neuroimaging data through elastic nets).</p>
<p>Long story short, one possible solution that is put forward in
<code>Pupilla</code> is quite simple, though arbitrary: we simply keep
track of the timepoints that are associated to a given threshold, e.g. a
t statistic of 1.9 as in this case, and we consider them to be in
agreement across folds if… these time points show up consistently across
folds! It’s as simple as that. In this specific example we ask for all
folds to be in agreement (&gt;99%), meaning that all timepoints must
remain significant regardless of which fold is left out from the data.
(This is to ensure that none of the folds has particular leverage in
driving the overal results). For the effects that we have specified, was
there a consensus across folds?</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cv</span><span class="op">$</span><span class="va">Consensus</span></span></code></pre></div>
<pre><code><span><span class="co">## $`(Intercept)`</span></span>
<span><span class="co">##   [1]  33  34  35  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239 240 241 242 243 244 245 246 247 248 249 250 251 252 253 254 255 256 257 258 259</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $Set_size2</span></span>
<span><span class="co">##   [1]  58  59  60  61  62  63  64  65  66  67  68  69  70  71  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 178</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $Set_size3</span></span>
<span><span class="co">##   [1]  47  48  49  50  51  52  53  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239 240 241 242 243 244 245 246 247 248 249 250 251 252 253 254 255 256 257 258 259 260 261 262 263 264 265 266 267 268 269 270 271 272 273 274 275 276 277 278 279 280 281 282 283 284 285 286 287 288 289 290 291 292 293 294</span></span>
<span><span class="co">## [249] 295 296 297 298 299 300</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $Set_size4</span></span>
<span><span class="co">##   [1]  49  50  51  52  53  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239 240 241 242 243 244 245 246 247 248 249 250 251 252 253 254 255 256 257 258 259 260 261 262 263 264 265 266 267 268 269 270 271 272 273 274 275 276 277 278 279 280 281 282 283 284 285 286 287 288 289 290 291 292 293 294 295 296</span></span>
<span><span class="co">## [249] 297 298 299 300</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $Color_typeproto</span></span>
<span><span class="co">## numeric(0)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $`Set_size2:Color_typeproto`</span></span>
<span><span class="co">## numeric(0)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $`Set_size3:Color_typeproto`</span></span>
<span><span class="co">## numeric(0)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $`Set_size4:Color_typeproto`</span></span>
<span><span class="co">##  [1] 136 138 139 141 142 143 144 145 146 147</span></span></code></pre>
<p>Yes! The consensus was very clear for each contrast within Set_size
<strong>and</strong> for the interaction with Color_type (1 vs 4), in
the latter case between sample 136 and 147. We can then formally test
the consensus window with another LMEM:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cv</span><span class="op">$</span><span class="va">Consensus_test</span></span></code></pre></div>
<pre><code><span><span class="co">##                      Effect    Test_t    Test_df       Test_p</span></span>
<span><span class="co">## 1               (Intercept) -2.447735   44.98978 0.0183421194</span></span>
<span><span class="co">## 2                 Set_size2  3.543109 7276.01207 0.0003979187</span></span>
<span><span class="co">## 3                 Set_size3  3.052632 7276.01359 0.0022766268</span></span>
<span><span class="co">## 4                 Set_size4  2.915928 7276.01471 0.0035571531</span></span>
<span><span class="co">## 5           Color_typeproto        NA         NA           NA</span></span>
<span><span class="co">## 6 Set_size2:Color_typeproto        NA         NA           NA</span></span>
<span><span class="co">## 7 Set_size3:Color_typeproto        NA         NA           NA</span></span>
<span><span class="co">## 8 Set_size4:Color_typeproto  2.685758 7274.04215 0.0072529680</span></span></code></pre>
<p>From which, again, the presence of an effect is confirmed.</p>
<p>To summarise, this approach has the advantage of returning a more
precise time window for the given experimental effect; it maintains the
computational efficiency of the crossvalidated approach; it is capable
to highlight potentially clusters that are not contiguous.</p>
<p>The downside is that few very arbitrary choices - e.g., the threshold
for the statistic - must be specified beforehand. My personal take on
the matter is that we, as researchers, should start being more
comfortable with our degrees of freedom, which are unavoidable in our
job, embrace them, and just resolve to tranparently report our choices
and avoid overselling stuff. But I get it, we are not really ingrained
to do that. Keep in mind that, however, this conflict can be resolved
very elegantly by preregistration of the experimental methods. At any
rate, this would be too long of a discussion for this vignette. Let’s
introduce the second approach pursued by <code>Pupilla</code>:
<strong>features reduction</strong>.</p>
</div>
</div>
<div class="section level2">
<h2 id="feature-reduction">Feature reduction<a class="anchor" aria-label="anchor" href="#feature-reduction"></a>
</h2>
<p>We live in a time of big data. As a result, it is often necessary
(and very empowering) to reduce the dimensions of the initial data to
few, much more manageable features that preserve most of the original
variability. For example through Principal components analysis or
Independent Components Analysis very rich data (e.g., neuroimaging) can
be reduced to very few features, which can then enter multivariate
analyses (see, e.g., <a href="https://eblini.github.io/FCnet/articles/FCnet_overview_of_package.html" class="external-link">FCnet</a>).
The same can be done with pupillometry data. In fact, because pupil
dilation is strongly autocorrelated in time, this approach is
potentially very effective. <code><a href="../reference/reduce_PCA.html">Pupilla::reduce_PCA()</a></code> and
<code><a href="../reference/reduce_ICA.html">Pupilla::reduce_ICA()</a></code> attempt to do that by summarising
each trial in very few scores; the scores reflect the contribution of
pupil diameter at each time point, weighted by the loadings matrix. The
loadings vary as a function of the importance of the contribution of
each time point, thus capturing some sort of relevant pattern in the
data.</p>
<p>The notation to do this in <code>Pupilla</code> is very similar to
what used above:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#the data</span></span>
<span><span class="va">data</span><span class="op">=</span> <span class="va">DF2</span></span>
<span><span class="co">#variables names should be supplied explicitly </span></span>
<span><span class="va">dv</span><span class="op">=</span> <span class="st">"Pupil"</span></span>
<span><span class="va">time</span><span class="op">=</span> <span class="st">"Time"</span></span>
<span><span class="va">id</span><span class="op">=</span> <span class="st">"Subject"</span></span>
<span><span class="va">trial</span><span class="op">=</span> <span class="st">"Trial"</span></span>
<span><span class="co">#append to the reduced dataframe</span></span>
<span><span class="va">add</span><span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Set_size"</span>, <span class="st">"Color_type"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rf</span> <span class="op">=</span> <span class="fu"><a href="../reference/reduce_PCA.html">reduce_PCA</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  dv <span class="op">=</span> <span class="va">dv</span>,</span>
<span>  time <span class="op">=</span> <span class="va">time</span>,</span>
<span>  id <span class="op">=</span> <span class="va">id</span>,</span>
<span>  trial <span class="op">=</span> <span class="va">trial</span>,</span>
<span>  add <span class="op">=</span> <span class="va">add</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in reduce_PCA(data = data, dv = dv, time = time, id = id, trial = trial, : NAs in the data will be discarded:</span></span>
<span><span class="co">##             check the data!</span></span></code></pre>
<p>We have used PCA (though ICA would be very similar in this specific
case). As we can see the approach is tremendously effective in reducing
the data, because only 2 components can explain more than 90% of the
original data! This means that we can summarise down each trial and
describe fairly well the pattern of pupil dilation with only 2
values!</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rf</span><span class="op">$</span><span class="va">summaryPCA</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##                               PC1        PC2       PC3       PC4</span></span>
<span><span class="co">## Standard deviation     3229.38700 1941.74683 722.69764 489.68396</span></span>
<span><span class="co">## Proportion of Variance    0.67641    0.24454   0.03388   0.01555</span></span>
<span><span class="co">## Cumulative Proportion     0.67641    0.92096   0.95483   0.97039</span></span></code></pre>
<p>Generally speaking the first component captures the main axis of
variability, and ends up describing at best the overall shape of the
curves seen in the original plot above. We can depict it as:</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_loadings.html">plot_loadings</a></span><span class="op">(</span><span class="st">"PC1"</span>, <span class="va">rf</span><span class="op">)</span></span></code></pre></div>
<p><img src="images/load_pc1-1.png"></p>
<p>The loadings suggest that the first PC captures an overall
dilation/constriction occurring in the late stages of the trial, after 1
second. (Keep in mind that the sign of the loadings is completely
arbitrary, this plot could very well be reversed, but we know from the
data that it probably refers to dilation.) Then, the following
components gruadually capture the remaining variability, e.g.:</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_loadings.html">plot_loadings</a></span><span class="op">(</span><span class="st">"PC2"</span>, <span class="va">rf</span><span class="op">)</span></span></code></pre></div>
<p><img src="images/load_pc2-1.png"></p>
<p>Meaning that the more you go on, the more you are likely to capture
very idiosincratic (and very small) trial-wise changes. It is not really
the case for this second component (24% of the variance explained),
which captures very well what is likely to be an initial response,
e.g. the pupillary light reflex. A note about the interpretation:
because PCA is a descriptive model, it does not imply any underlying,
originating process. The interpretation part is completely up to the
experimenter. This would be the case, however, for any inferential
technique. And for most uses, the shape of the loadings plot is more
likely to highlight segregated, at least partially independent
processes.</p>
<p>We move forward by assessing, thus, the obtained scores. Scores can
be, of course, summarised per subject to perform classic ANOVAs, or used
as such within LMEMs. We choose the second approach for now, though we
still summarise the data for depiction purposes.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#summarise scores</span></span>
<span><span class="va">Scores</span><span class="op">=</span> <span class="va">rf</span><span class="op">$</span><span class="va">Scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">Set_size</span>, <span class="va">Color_type</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>PC1<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">PC1</span><span class="op">)</span>,</span>
<span>            PC2<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">PC2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">Scores</span><span class="op">$</span><span class="va">Set_size</span><span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">Scores</span><span class="op">$</span><span class="va">Set_size</span><span class="op">)</span></span>
<span><span class="va">rf</span><span class="op">$</span><span class="va">Scores</span><span class="op">$</span><span class="va">Set_size</span><span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">rf</span><span class="op">$</span><span class="va">Scores</span><span class="op">$</span><span class="va">Set_size</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="pc1">PC1<a class="anchor" aria-label="anchor" href="#pc1"></a>
</h3>
<p>We can fit a LMEM model for the first PC:</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod_pc1</span><span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/lmerTest/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">PC1</span> <span class="op">~</span> <span class="va">Color_type</span><span class="op">*</span><span class="va">Set_size</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">id</span><span class="op">)</span>,</span>
<span>              <span class="va">rf</span><span class="op">$</span><span class="va">Scores</span><span class="op">)</span> <span class="co">#note that we used the original dataframe</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod_pc1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Linear mixed model fit by REML. t-tests use Satterthwaite's method ['lmerModLmerTest']</span></span>
<span><span class="co">## Formula: PC1 ~ Color_type * Set_size + (1 | id)</span></span>
<span><span class="co">##    Data: rf$Scores</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## REML criterion at convergence: 134493.4</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Scaled residuals: </span></span>
<span><span class="co">##     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">## -4.9087 -0.6031  0.0047  0.6025  5.8052 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Random effects:</span></span>
<span><span class="co">##  Groups   Name        Variance Std.Dev.</span></span>
<span><span class="co">##  id       (Intercept) 1662005  1289    </span></span>
<span><span class="co">##  Residual             7524608  2743    </span></span>
<span><span class="co">## Number of obs: 7202, groups:  id, 30</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Fixed effects:</span></span>
<span><span class="co">##                           Estimate Std. Error       df t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept)               -1813.69     252.48    36.97  -7.184 1.62e-08 ***</span></span>
<span><span class="co">## Color_typeproto            -179.27     129.73  7165.06  -1.382   0.1670    </span></span>
<span><span class="co">## Set_size2                   608.64     129.25  7165.04   4.709 2.54e-06 ***</span></span>
<span><span class="co">## Set_size3                  1564.30     128.97  7165.05  12.129  &lt; 2e-16 ***</span></span>
<span><span class="co">## Set_size4                  2146.06     129.19  7165.08  16.612  &lt; 2e-16 ***</span></span>
<span><span class="co">## Color_typeproto:Set_size2   241.04     183.28  7165.05   1.315   0.1885    </span></span>
<span><span class="co">## Color_typeproto:Set_size3   119.03     182.78  7165.06   0.651   0.5149    </span></span>
<span><span class="co">## Color_typeproto:Set_size4   398.82     183.16  7165.08   2.177   0.0295 *  </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Correlation of Fixed Effects:</span></span>
<span><span class="co">##             (Intr) Clr_ty St_sz2 St_sz3 St_sz4 C_:S_2 C_:S_3</span></span>
<span><span class="co">## Colr_typprt -0.255                                          </span></span>
<span><span class="co">## Set_size2   -0.256  0.498                                   </span></span>
<span><span class="co">## Set_size3   -0.256  0.499  0.501                            </span></span>
<span><span class="co">## Set_size4   -0.256  0.498  0.500  0.501                     </span></span>
<span><span class="co">## Clr_typ:S_2  0.180 -0.708 -0.705 -0.353 -0.352              </span></span>
<span><span class="co">## Clr_typ:S_3  0.181 -0.710 -0.353 -0.706 -0.353  0.502       </span></span>
<span><span class="co">## Clr_typ:S_4  0.180 -0.708 -0.352 -0.353 -0.705  0.501  0.503</span></span></code></pre>
<p>To see, again, the large effect of Set_size, and the interaction with
Color_type occurring for the 1 vs 4 contrast. With the package
<code>emmeans</code> we can avoid refactoring to compute all
contrasts:</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/emmeans/man/emm_options.html" class="external-link">emm_options</a></span><span class="op">(</span>lmer.df <span class="op">=</span> <span class="st">"asymptotic"</span><span class="op">)</span></span>
<span><span class="va">mm</span><span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/emmeans/man/emmeans.html" class="external-link">emmeans</a></span><span class="op">(</span><span class="va">mod_pc1</span>, <span class="op">~</span> <span class="va">Color_type</span><span class="op">:</span><span class="va">Set_size</span><span class="op">)</span></span>
<span><span class="va">mm</span></span></code></pre></div>
<pre><code><span><span class="co">##  Color_type Set_size emmean  SE  df asymp.LCL asymp.UCL</span></span>
<span><span class="co">##  nonproto   1         -1814 252 Inf     -2309     -1319</span></span>
<span><span class="co">##  proto      1         -1993 253 Inf     -2488     -1498</span></span>
<span><span class="co">##  nonproto   2         -1205 253 Inf     -1700      -710</span></span>
<span><span class="co">##  proto      2         -1143 253 Inf     -1638      -648</span></span>
<span><span class="co">##  nonproto   3          -249 252 Inf      -744       245</span></span>
<span><span class="co">##  proto      3          -310 252 Inf      -804       185</span></span>
<span><span class="co">##  nonproto   4           332 252 Inf      -162       827</span></span>
<span><span class="co">##  proto      4           552 253 Inf        57      1047</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Degrees-of-freedom method: asymptotic </span></span>
<span><span class="co">## Confidence level used: 0.95</span></span></code></pre>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/emmeans/man/contrast.html" class="external-link">contrast</a></span><span class="op">(</span><span class="va">mm</span>, method <span class="op">=</span> <span class="st">"pairwise"</span>, interaction <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  Color_type_pairwise Set_size_pairwise estimate  SE  df z.ratio p.value</span></span>
<span><span class="co">##  nonproto - proto    1 - 2                  241 183 Inf   1.315  0.1885</span></span>
<span><span class="co">##  nonproto - proto    1 - 3                  119 183 Inf   0.651  0.5149</span></span>
<span><span class="co">##  nonproto - proto    1 - 4                  399 183 Inf   2.177  0.0295</span></span>
<span><span class="co">##  nonproto - proto    2 - 3                 -122 183 Inf  -0.668  0.5040</span></span>
<span><span class="co">##  nonproto - proto    2 - 4                  158 183 Inf   0.862  0.3885</span></span>
<span><span class="co">##  nonproto - proto    3 - 4                  280 182 Inf   1.533  0.1252</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Degrees-of-freedom method: asymptotic</span></span></code></pre>
<p>This is, indeed, the only significant contrast. We can see that there
is an inversion in the effect of prototypical / non-prototypical color
between the two set sizes.</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">Scores</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y<span class="op">=</span> <span class="va">PC1</span>, x<span class="op">=</span> <span class="va">Set_size</span>, fill<span class="op">=</span> <span class="va">Color_type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>text<span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span> <span class="fl">16</span>,</span>
<span>                           face<span class="op">=</span><span class="st">"bold"</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<p><img src="images/unnamed-chunk-17-1.png"></p>
</div>
<div class="section level3">
<h3 id="pc2">PC2<a class="anchor" aria-label="anchor" href="#pc2"></a>
</h3>
<p>For PC2, on the other hand:</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod_pc2</span><span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/lmerTest/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">PC2</span> <span class="op">~</span> <span class="va">Color_type</span><span class="op">*</span><span class="va">Set_size</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">id</span><span class="op">)</span>, </span>
<span>              <span class="va">rf</span><span class="op">$</span><span class="va">Scores</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod_pc2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Linear mixed model fit by REML. t-tests use Satterthwaite's method ['lmerModLmerTest']</span></span>
<span><span class="co">## Formula: PC2 ~ Color_type * Set_size + (1 | id)</span></span>
<span><span class="co">##    Data: rf$Scores</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## REML criterion at convergence: 121258.8</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Scaled residuals: </span></span>
<span><span class="co">##     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">## -5.0713 -0.5643 -0.0062  0.5856  5.9442 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Random effects:</span></span>
<span><span class="co">##  Groups   Name        Variance Std.Dev.</span></span>
<span><span class="co">##  id       (Intercept)  473867   688.4  </span></span>
<span><span class="co">##  Residual             1192655  1092.1  </span></span>
<span><span class="co">## Number of obs: 7202, groups:  id, 30</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Fixed effects:</span></span>
<span><span class="co">##                           Estimate Std. Error      df t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept)                1407.13     130.84   33.35  10.755 2.22e-12 ***</span></span>
<span><span class="co">## Color_typeproto             -79.48      51.65 7165.03  -1.539  0.12388    </span></span>
<span><span class="co">## Set_size2                  -135.53      51.46 7165.02  -2.634  0.00846 ** </span></span>
<span><span class="co">## Set_size3                    58.57      51.35 7165.03   1.141  0.25401    </span></span>
<span><span class="co">## Set_size4                   372.42      51.43 7165.05   7.241 4.92e-13 ***</span></span>
<span><span class="co">## Color_typeproto:Set_size2   -24.67      72.97 7165.03  -0.338  0.73534    </span></span>
<span><span class="co">## Color_typeproto:Set_size3    37.29      72.77 7165.04   0.512  0.60836    </span></span>
<span><span class="co">## Color_typeproto:Set_size4    25.15      72.92 7165.05   0.345  0.73014    </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Correlation of Fixed Effects:</span></span>
<span><span class="co">##             (Intr) Clr_ty St_sz2 St_sz3 St_sz4 C_:S_2 C_:S_3</span></span>
<span><span class="co">## Colr_typprt -0.196                                          </span></span>
<span><span class="co">## Set_size2   -0.196  0.498                                   </span></span>
<span><span class="co">## Set_size3   -0.197  0.499  0.501                            </span></span>
<span><span class="co">## Set_size4   -0.197  0.498  0.500  0.501                     </span></span>
<span><span class="co">## Clr_typ:S_2  0.139 -0.708 -0.705 -0.353 -0.352              </span></span>
<span><span class="co">## Clr_typ:S_3  0.139 -0.710 -0.353 -0.706 -0.353  0.502       </span></span>
<span><span class="co">## Clr_typ:S_4  0.139 -0.708 -0.352 -0.353 -0.705  0.501  0.503</span></span></code></pre>
<p>We find no such effect, reiterating that the interaction probably
appears later on in the course of the trial.</p>
</div>
</div>
<div class="section level2">
<h2 id="rotated-principal-components-analysis">Rotated Principal Components Analysis<a class="anchor" aria-label="anchor" href="#rotated-principal-components-analysis"></a>
</h2>
<p>The loadings can be “rotated” so that: 1) their interpretation is
easier (e.g., few timepoints are set closer to 0, some are increased);
2) components are not orthogonal but can correlate. As a result, the
model performs slightly worse in terms of explained variance, but may
allow one a better, clearer interpretation of the loadings, and may
relax some unrealistic assumption such as that different components do
not interact (correlate) significantly. The implementation is outlined
below. Please note that while <code><a href="../reference/reduce_PCA.html">reduce_PCA()</a></code> follows
<code><a href="https://rdrr.io/r/stats/prcomp.html" class="external-link">prcomp()</a></code>, this function follows
<code><a href="https://rdrr.io/pkg/psych/man/principal.html" class="external-link">psych::principal()</a></code> including the standardization of the
loadings (that is, even <code>rotate</code> is <code>"none"</code>
results differ slightly).</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#the data</span></span>
<span><span class="va">data</span><span class="op">=</span> <span class="va">DF2</span></span>
<span><span class="co">#variables names should be supplied explicitly </span></span>
<span><span class="va">dv</span><span class="op">=</span> <span class="st">"Pupil"</span></span>
<span><span class="va">time</span><span class="op">=</span> <span class="st">"Time"</span></span>
<span><span class="va">id</span><span class="op">=</span> <span class="st">"Subject"</span></span>
<span><span class="va">trial</span><span class="op">=</span> <span class="st">"Trial"</span></span>
<span><span class="va">rotate</span><span class="op">=</span> <span class="st">"promax"</span> <span class="co">#oblique rotation</span></span>
<span><span class="co">#append to the reduced dataframe</span></span>
<span><span class="va">add</span><span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Set_size"</span>, <span class="st">"Color_type"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rf2</span> <span class="op">=</span> <span class="fu"><a href="../reference/reduce_rPCA.html">reduce_rPCA</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  dv <span class="op">=</span> <span class="va">dv</span>,</span>
<span>  time <span class="op">=</span> <span class="va">time</span>,</span>
<span>  id <span class="op">=</span> <span class="va">id</span>,</span>
<span>  trial <span class="op">=</span> <span class="va">trial</span>,</span>
<span>  rotate<span class="op">=</span> <span class="va">rotate</span>,</span>
<span>  add <span class="op">=</span> <span class="va">add</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in reduce_rPCA(data = data, dv = dv, time = time, id = id, trial = trial, : NAs in the data will be discarded:</span></span>
<span><span class="co">##             check the data!</span></span></code></pre>
<pre><code><span><span class="co">## The determinant of the smoothed correlation was zero.</span></span>
<span><span class="co">## This means the objective function is not defined.</span></span>
<span><span class="co">## Chi square is based upon observed residuals.</span></span></code></pre>
<pre><code><span><span class="co">## The determinant of the smoothed correlation was zero.</span></span>
<span><span class="co">## This means the objective function is not defined for the null model either.</span></span>
<span><span class="co">## The Chi square is thus based upon observed correlations.</span></span></code></pre>
<p>Here’s how the loadings now look:</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_loadings.html">plot_loadings</a></span><span class="op">(</span><span class="st">"RC1"</span>, <span class="va">rf2</span><span class="op">)</span></span></code></pre></div>
<p><img src="images/unnamed-chunk-20-1.png"></p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_loadings.html">plot_loadings</a></span><span class="op">(</span><span class="st">"RC2"</span>, <span class="va">rf2</span><span class="op">)</span></span></code></pre></div>
<p><img src="images/unnamed-chunk-20-2.png"></p>
<p>So, notwistanding the differences in the implementation of the PCA -
based on the covariance matrix for <code><a href="https://rdrr.io/pkg/psych/man/principal.html" class="external-link">psych::principal()</a></code>, in
this case the second component is more clearly referring to the early
part of the trial, presumably PLR.</p>
</div>
<div class="section level2">
<h2 id="discussion">Discussion<a class="anchor" aria-label="anchor" href="#discussion"></a>
</h2>
<p>The aim of this vignette was to present the two main analytical
approaches of <code>Pupilla</code>. I am not familiar enough with the
domain of the original study to adventure myself in theoretical
interpretations. Suffice to say that, in my opinion, the crossvalidation
approach appears to replicate quite well - notwithstanding differences
in the implementation - the results reported by the authors.
Furthermore, an argument could be made about the utility of a
<em>consensus</em> across folds to enhance the precision in identifying
a temporal cluster. For what concerns the second approach, i.e. via
feature reduction, we have also seen pretty coherent results. I would
not go as far as saying that the loadings of PC1 can identify a temporal
cluster. In a sense, they would, though not of course a dichotomic one,
but rather a much more graded, continuous one. All I care to say here,
however, is that this approach could represent a viable option for when
the collected data is really huge, in that it would allow one to obtain
few, much more manageable variables that can be further exploited for
all sorts of modelling purposes. Furthermore, these variables may be
more easy to interpret - albeit this is, however, still to better
understand with more research.</p>
</div>
<div class="section level2">
<h2 id="appendix">Appendix<a class="anchor" aria-label="anchor" href="#appendix"></a>
</h2>
<p>Packages’ versions:</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## R version 4.2.3 (2023-03-15 ucrt)</span></span>
<span><span class="co">## Platform: x86_64-w64-mingw32/x64 (64-bit)</span></span>
<span><span class="co">## Running under: Windows 10 x64 (build 19045)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">## [1] LC_COLLATE=Italian_Italy.utf8  LC_CTYPE=Italian_Italy.utf8    LC_MONETARY=Italian_Italy.utf8 LC_NUMERIC=C                   LC_TIME=Italian_Italy.utf8    </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">##  [1] zoo_1.8-12         lmerTest_3.1-3     lme4_1.1-35.1      Matrix_1.6-5       emmeans_1.10.0     ggplot2_3.4.4      dplyr_1.1.4        usethis_2.2.2      pkgdown_2.0.7      Pupilla_0.0.0.9001</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##  [1] tidyr_1.3.1         jsonlite_1.8.8      splines_4.2.3       askpass_1.2.0       highr_0.10          yaml_2.3.8          numDeriv_2016.8-1.1 pillar_1.9.0        lattice_0.22-5      glue_1.7.0          reticulate_1.35.0   digest_0.6.34       minqa_1.2.6         colorspace_2.1-0    sandwich_3.1-0      htmltools_0.5.7     psych_2.4.1         pkgconfig_2.0.3     purrr_1.0.2         xtable_1.8-4        gitcreds_0.1.2      mvtnorm_1.2-4       scales_1.3.0        processx_3.8.3      tibble_3.2.1        openssl_2.1.1       farver_2.1.1        generics_0.1.3      TH.data_1.1-2       cachem_1.0.8        withr_3.0.0         credentials_2.0.1   cli_3.6.2           mnormt_2.1.1        survival_3.5-3      magrittr_2.0.3      crayon_1.5.2        memoise_2.0.1       estimability_1.4.1  evaluate_0.23       ps_1.7.6            fs_1.6.3            fansi_1.0.6         nlme_3.1-162        MASS_7.3-58.2       ica_1.0-3           httr2_1.0.0         tools_4.2.3         gh_1.4.0           </span></span>
<span><span class="co">## [50] lifecycle_1.0.4     multcomp_1.4-25     gert_2.0.1          munsell_0.5.0       callr_3.7.3         compiler_4.2.3      rlang_1.1.3         grid_4.2.3          nloptr_2.0.3        rstudioapi_0.15.0   sys_3.4.2           rappdirs_0.3.3      labeling_0.4.3      rmarkdown_2.25      boot_1.3-28.1       gtable_0.3.4        codetools_0.2-19    curl_5.2.0          R6_2.5.1            knitr_1.45          fastmap_1.1.1       utf8_1.2.4          rprojroot_2.0.4     desc_1.4.3          parallel_4.2.3      Rcpp_1.0.12         vctrs_0.6.5         png_0.1-8           tidyselect_1.2.0    xfun_0.41           coda_0.19-4.1</span></span></code></pre>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Elvio Blini.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
