<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function is meant to implement, roughly and with no assurance of full compatibility whatsoever,
the procedure proposed by Mathôt and Vilotijević (2022, Behavior Research Methods).
First, each trial (i.e., one complete time series) is assigned to one fold in a
deterministic fashion (the first trial to the first fold, then the second trial to
the second fold, etc.). In doing that, there is no regard of how conditions are
distributed across folds, i.e. data may be slightly unbalanced; thus, you should think
carefully as to whether this strategy applies to your design (e.g., blocked conditions).
Then, data are separated for each time-point, and a LMEM as specified by the 'formula'
parameter, which is passed to 'lmerTest::lmer', is performed by iteratively leaving
one fold out. This results in a table, with as many rows as effects implied
by the formula by 'nfolds', summarising which time point had a peak t-value (in absolute value)
in the trained folds. In a separate table these peak values are tested: the dependent
variable becomes, for each fold, the variable provided by 'dv' at that specific peak.
Another LMEM is then computed by using this newly created variable. One problem with
this approach is that peak values can be all over the places, depending on your data.
Also, choosing the time-points based on the maximum value in the training dataset can
occasionally decrease the precision of the estimate or give overfitting. You may use
this approach if you are confident that a specific effect only has an effect at a specific
window; effects with multiple windows - e.g., an early and late impact on pupil size - may
not be properly captured with this approach. Therefore,
in addition to this procedure, a very coarse consensus is seek by assessing,
across all folds and effects, which time points resulted in t-values above a certain
threshold; if the same time points pop out consistently across folds (e.g.,= 'consensus_thresh' % of the times), then the time point is retained; all time-pointsretained in the consensus are collapsed (averaged), and a final LMEM is performed withthese time points. This can be interpreted more similarly to a cluster-basedpermutation test (although it is not the same)."><title>Highlights and test the time-course of effects through crossvalidation — decode_signal • Pupilla</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Highlights and test the time-course of effects through crossvalidation — decode_signal"><meta property="og:description" content="This function is meant to implement, roughly and with no assurance of full compatibility whatsoever,
the procedure proposed by Mathôt and Vilotijević (2022, Behavior Research Methods).
First, each trial (i.e., one complete time series) is assigned to one fold in a
deterministic fashion (the first trial to the first fold, then the second trial to
the second fold, etc.). In doing that, there is no regard of how conditions are
distributed across folds, i.e. data may be slightly unbalanced; thus, you should think
carefully as to whether this strategy applies to your design (e.g., blocked conditions).
Then, data are separated for each time-point, and a LMEM as specified by the 'formula'
parameter, which is passed to 'lmerTest::lmer', is performed by iteratively leaving
one fold out. This results in a table, with as many rows as effects implied
by the formula by 'nfolds', summarising which time point had a peak t-value (in absolute value)
in the trained folds. In a separate table these peak values are tested: the dependent
variable becomes, for each fold, the variable provided by 'dv' at that specific peak.
Another LMEM is then computed by using this newly created variable. One problem with
this approach is that peak values can be all over the places, depending on your data.
Also, choosing the time-points based on the maximum value in the training dataset can
occasionally decrease the precision of the estimate or give overfitting. You may use
this approach if you are confident that a specific effect only has an effect at a specific
window; effects with multiple windows - e.g., an early and late impact on pupil size - may
not be properly captured with this approach. Therefore,
in addition to this procedure, a very coarse consensus is seek by assessing,
across all folds and effects, which time points resulted in t-values above a certain
threshold; if the same time points pop out consistently across folds (e.g.,= 'consensus_thresh' % of the times), then the time point is retained; all time-pointsretained in the consensus are collapsed (averaged), and a final LMEM is performed withthese time points. This can be interpreted more similarly to a cluster-basedpermutation test (although it is not the same)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">Pupilla</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9001</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/Pupilla.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Pupilla_Advanced_statistical_analyses.html">Pupilla::Advanced statistical analyses</a>
    <a class="dropdown-item" href="../articles/Pupilla_Eyelink_SingleSubjectPreprocessing.html">Pupilla::EyeLink::Read and preprocessing</a>
    <a class="dropdown-item" href="../articles/Pupilla_TOBII_ReduceFeatures.html">Pupilla_TOBII_ReduceFeatures</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/EBlini/Pupilla/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Highlights and test the time-course of effects through crossvalidation</h1>
      <small class="dont-index">Source: <a href="https://github.com/EBlini/Pupilla/blob/HEAD/R/decode_signal.R" class="external-link"><code>R/decode_signal.R</code></a></small>
      <div class="d-none name"><code>decode_signal.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function is meant to implement, roughly and with no assurance of full compatibility whatsoever,
the procedure proposed by Mathôt and Vilotijević (2022, <em>Behavior Research Methods</em>).
First, each trial (i.e., one complete time series) is assigned to one fold in a
deterministic fashion (the first trial to the first fold, then the second trial to
the second fold, etc.). In doing that, there is no regard of how conditions are
distributed across folds, i.e. data may be slightly unbalanced; thus, you should think
carefully as to whether this strategy applies to your design (e.g., blocked conditions).
Then, data are separated for each time-point, and a LMEM as specified by the 'formula'
parameter, which is passed to 'lmerTest::lmer', is performed by iteratively leaving
one fold out. This results in a table, with as many rows as effects implied
by the formula by 'nfolds', summarising which time point had a peak t-value (in absolute value)
in the trained folds. In a separate table these peak values are tested: the dependent
variable becomes, for each fold, the variable provided by 'dv' at that specific peak.
Another LMEM is then computed by using this newly created variable. One problem with
this approach is that peak values can be all over the places, depending on your data.
Also, choosing the time-points based on the maximum value in the training dataset can
occasionally decrease the precision of the estimate or give overfitting. You may use
this approach if you are confident that a specific effect only has an effect at a specific
window; effects with multiple windows - e.g., an early and late impact on pupil size - may
not be properly captured with this approach. Therefore,
in addition to this procedure, a very coarse consensus is seek by assessing,
across all folds and effects, which time points resulted in t-values above a certain
threshold; if the same time points pop out consistently across folds (e.g.,= 'consensus_thresh' % of the times), then the time point is retained; all time-pointsretained in the consensus are collapsed (averaged), and a final LMEM is performed withthese time points. This can be interpreted more similarly to a cluster-basedpermutation test (although it is not the same).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">decode_signal</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">formula</span>,</span>
<span>  <span class="va">dv</span>,</span>
<span>  <span class="va">time</span>,</span>
<span>  <span class="va">id</span>,</span>
<span>  <span class="va">trial</span>,</span>
<span>  nfolds <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  t_thresh <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  consensus_thresh <span class="op">=</span> <span class="fl">0.75</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>data</dt>
<dd><p>A data.frame containing all the necessary variables.</p></dd>


<dt>formula</dt>
<dd><p>A 'lme4'-style formula, passed as a string.</p></dd>


<dt>dv</dt>
<dd><p>A string indicating the name of the dependent variable.</p></dd>


<dt>time</dt>
<dd><p>A string indicating the name of the time variable.</p></dd>


<dt>id</dt>
<dd><p>A string indicating the name of the id (participant) variable.</p></dd>


<dt>trial</dt>
<dd><p>A string indicating the name of the trial variable.</p></dd>


<dt>nfolds</dt>
<dd><p>Number of folds to split trials in. Defaults to 4.</p></dd>


<dt>t_thresh</dt>
<dd><p>Used to seek consensus: the minimum t-value required to push the
time-point forward.</p></dd>


<dt>consensus_thresh</dt>
<dd><p>The minimum proportion of time-points that must be above
't_thresh' across folds in order to keep the time-point in the consensus.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A list including: peaks retained for each (left-out) fold; test of the
retained, cross-validated peaks; test of the consensus time-points, if any; list
of time-points retained in the consensus for each effect.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Elvio Blini.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

